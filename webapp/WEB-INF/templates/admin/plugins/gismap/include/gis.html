<script src="js/autocomplete/jquery.session.js"></script>
<script>
<#assign idEntry = "">
<#if entry?? && entry.idEntry?has_content >
	<#assign idEntry = entry.idEntry >
</#if>
var idMap${idEntry} = '${idEntry}_map';
var parameters${idEntry} = [];
var fieldParameters${idEntry} = [];
ol.proj.setProj4(proj4);


<#list map_parameter.parameters?keys as key>
	<#assign strKey = "'" + key + "'">
	<#assign strVal = map_parameter.parameters[key] >
	parameters${idEntry}.push(parameters${idEntry}[${strKey}] = ${strVal});
</#list>

<#if extent_current_val?? && visible_layer_val?? >
	parameters${idEntry}.push(parameters${idEntry}['ExtentContext'] = ${extent_current_val} );
	parameters${idEntry}.push(parameters${idEntry}['ListLayersVisible'] = ${visible_layer_val} );
<#else>
	parameters${idEntry}.push(parameters${idEntry}['ExtentContext'] = [615232.2006719088,6839076.82203539,682582.7573180367,6873244.656392432]);
	parameters${idEntry}.push(parameters${idEntry}['ListLayersVisible'] = ['MapQuest',false,'OSM',true,'Otrho_Paris',false,'Otrho_Paris_Tiled',false,'World_Simple_WMS',false,'Arrondissements_Ideation',true,'Popup_WMS',true,'Arrondissements',true,'Souillure',true,'Plan_Voirie',false,'HeatMap',false]);
</#if>

<#if fieldParam?? >
<#list fieldParam?keys as key>
	<#assign strKey = "'" + key + "'" >
	<#assign strVal = "'" + fieldParam[key] + "'" >
	<#if strKey == "'UrlGeoJSON1'">
		<#assign strValGeo = "'Lutece'" >
		<#assign strValGeo = "${map_parameter.parameters['GeoJSON1']}"?split(",")[0] >
		<#assign strValGeo = "${strValGeo}"?split("[")[1] >
		fieldParameters${idEntry}.push(fieldParameters${idEntry}[${strKey}] = [${strValGeo},${strVal}]);
	<#else>
		fieldParameters${idEntry}.push(fieldParameters${idEntry}[${strKey}] = ${strVal});
	</#if>
	
</#list>
<#else>
	fieldParameters${idEntry}.push(fieldParameters${idEntry}['TypeEdit']='');
	fieldParameters${idEntry}.push(fieldParameters${idEntry}['GeomGeoJson']='GeomGeoJson');
	fieldParameters${idEntry}.push(fieldParameters${idEntry}['GeomCentroidXStockage']='GeomCentroidXStockage');
	fieldParameters${idEntry}.push(fieldParameters${idEntry}['GeomCentroidYStockage']='GeomCentroidYStockage');
	fieldParameters${idEntry}.push(fieldParameters${idEntry}['GeomCentroidXGeocodage']='GeomCentroidXGeocodage');
	fieldParameters${idEntry}.push(fieldParameters${idEntry}['GeomCentroidYGeocodage']='GeomCentroidYGeocodage');
	fieldParameters${idEntry}.push(fieldParameters${idEntry}['GeomState']='GeomState');
	fieldParameters${idEntry}.push(fieldParameters${idEntry}['UrlGeoJSON1']=['Test','http://localhost:8081/myapp/myresource']);
</#if>

var GisMapDisplay${idEntry} = new GisMap(idMap${idEntry}, ${idEntry});
GisMapDisplay${idEntry}.initGisMap(parameters${idEntry}, fieldParameters${idEntry});

</script>