<script>
<#assign idEntry = "">
<#if entry?? && entry.idEntry?has_content >
	<#assign idEntry = entry.idEntry >
</#if>
var idMap${idEntry} = '${idEntry}_map';
var parameters${idEntry} = [];
var fieldParameters${idEntry} = [];
ol.proj.setProj4(proj4);

<#list map_parameter.parameters?keys as key>
	<#assign strKey = "'" + key + "'">
	<#assign strVal = map_parameter.parameters[key] >
	parameters${idEntry}.push(parameters${idEntry}[${strKey}] = ${strVal});
</#list>

var varExtentContext${idEntry} = $('#${idEntry}_extentCurrent').val();

var varListLayersVisible${idEntry} = $('#${idEntry}_visibleLayer').val();

parameters${idEntry}.push(parameters${idEntry}['ExtentContext'] = varExtentContext${idEntry} );
parameters${idEntry}.push(parameters${idEntry}['ListLayersVisible'] = varListLayersVisible${idEntry} );
//parameters${idEntry}.push(parameters${idEntry}['ExtentContext'] = [641519.1384852936,6845868.910503937,656295.8195046519,6866452.567923885]);
//parameters${idEntry}.push(parameters${idEntry}['ListLayersVisible'] = ['MapQuest',true,'OSM',false,'Otrho_Paris',false,'Otrho_Paris_Tiled',false,'Topp',true,'World_Simple_WMS',false,'Arrondissements_Ideation',false,'Popup_WMS',true,'Arrondissements',false,'Souillure',false,'Plan_Voirie',false,'HeatMap',true]);

<#if fieldParam?? >
<#list fieldParam?keys as key>
	<#assign strKey = "'" + key + "'" >
	<#assign strVal = "'" + fieldParam[key] + "'" >
	<#if strKey == "'UrlGeoJSON1'">
		<#assign strValGeo = "'Lutece'" >
		<#assign strValGeo = "${map_parameter.parameters['GeoJSON1']}"?split(",")[0] >
		<#assign strValGeo = "${strValGeo}"?split("[")[1] >
		fieldParameters${idEntry}.push(fieldParameters${idEntry}[${strKey}] = [${strValGeo},${strVal}]);
	<#else>
		fieldParameters${idEntry}.push(fieldParameters${idEntry}[${strKey}] = ${strVal});
	</#if>
	
</#list>
<#else>
	fieldParameters${idEntry}.push(fieldParameters${idEntry}['TypeEdit']='');
	fieldParameters${idEntry}.push(fieldParameters${idEntry}['GeomGeoJson']='GeomGeoJson');
	fieldParameters${idEntry}.push(fieldParameters${idEntry}['GeomCentroidXStockage']='GeomCentroidXStockage');
	fieldParameters${idEntry}.push(fieldParameters${idEntry}['GeomCentroidYStockage']='GeomCentroidYStockage');
	fieldParameters${idEntry}.push(fieldParameters${idEntry}['GeomCentroidXGeocodage']='GeomCentroidXGeocodage');
	fieldParameters${idEntry}.push(fieldParameters${idEntry}['GeomCentroidYGeocodage']='GeomCentroidYGeocodage');
	fieldParameters${idEntry}.push(fieldParameters${idEntry}['GeomState']='GeomState');
	fieldParameters${idEntry}.push(fieldParameters${idEntry}['UrlGeoJSON1']=['Test','http://localhost:8081/myapp/myresource']);
</#if>

var GisMapDisplay${idEntry} = new GisMap(idMap${idEntry}, ${idEntry});
GisMapDisplay${idEntry}.initGisMap(parameters${idEntry}, fieldParameters${idEntry});

</script>