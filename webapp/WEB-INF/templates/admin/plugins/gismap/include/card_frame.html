<#assign idEntry = "">
<#if entry?? && entry.idEntry?has_content >
	<#assign idEntry = entry.idEntry >
</#if>
<#assign strValPrint = "false" >
<#list map_parameter.parameters?keys as key>
	<#assign strKey = "'" + key + "'">
	<#if strKey == "'Print'">
		<#assign strValPrint = map_parameter.parameters[key] >
	</#if>
</#list>

<#assign strValHeight = 350 >
<#list map_parameter.parameters?keys as key>
	<#assign strKey = "'" + key + "'">
	<#if strKey == "'Height'">
		<#assign strValHeight = map_parameter.parameters[key] >
	</#if>
</#list>

<div>
	<input type="hidden" id="${idEntry}_geomCentroidXGeocodage" value=""/>
    <input type="hidden" id="${idEntry}_geomCentroidYGeocodage" value=""/>
    <input type="hidden" id="${idEntry}_geomState" value='false'/>
    <input type="hidden" id="${idEntry}_extentCurrent" value=""/>
    <input type="hidden" id="${idEntry}_visibleLayer" value=""/>
    
    <div id="${idEntry}_map" class="map" style="height: ${strValHeight}px"><div id="popup"></div></div>
    
    <button id="zoomSelect" type="button" onClick="GisMapDisplay${idEntry}.getZoom().zoomSelect()">Zoom To</button>
    <#if editModeValue?? && editModeValue=="">
	    <button id="SelectVia" type="button" onClick="selectObjectLuteceViaMap(GisMapDisplay${idEntry}.getInteract().getSpecificInteract().getSpecificSelectedFeatures())">Select Object lutece via Map</button>
	    <button id="SelectTo" type="button" onClick="GisMapDisplay${idEntry}.getInteract().getSpecificInteract().setSpecificSelectedFeatures(selectObjectMapViaLutece())">Select Object Map via Lutece</button>
    </#if>
    <a id="mapPrint" class="btn" download="map.png" <#if strValPrint == "false"> style="display: none" </#if> ><input type="button" value="Print Map"></a>
    
    <!-- <script src="js/gismap/GisTest.js" type="text/javascript"></script> -->
    
    <!-- <script src="js/Gis.js" type="text/javascript"></script> </script> -->
</div>

<script>

$( "#${idEntry}_map" )
.mouseout(function() {
	GisMapDisplay${idEntry}.getInteract().getEditor().forceValidate();
	geocodage();
});

function selectObjectLuteceViaMap( idSelected ){
	$( ".selected-id" ).each(function(  ) {
		var id = this.value;
		if(inIdSelected(id, idSelected)==true){
			document.getElementById("selected_record_" + id ).checked = true;
		}
		else{
			document.getElementById("selected_record_" + id ).checked = false;
		}
		});
};
function selectObjectMapViaLutece(  ){
	var idSelected = [];
	var i = 0;
	$( ".selected-id" ).each(function(  ) {
		var id = this.value;
		if(document.getElementById("selected_record_" + id ).checked == true){
			idSelected[i] = id;
			i++;
		}
	});
	return idSelected;
};
function inIdSelected(id, idSelected){
	var varBoolean = false;
	for	(index = 0; index < idSelected.length; index++) {
		var idIndex = idSelected[index];
		if(idIndex == id){
			varBoolean = true;
			return varBoolean;
		}
	}
	return varBoolean;
};
</script>